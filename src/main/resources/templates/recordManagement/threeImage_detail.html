<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout_sub}">
<div layout:fragment="content_sub">
    <div>
        <div class="w_90vw">
            <img id="3dImage" src="/static/images/three/three_test.png">
            <div class="" style="display: inline-block">
                <canvas id="canvas3" width="600" height="500"></canvas>
            </div>
            <input id="t_test" type="hidden" value="/static/images/three/scene.gltf">
        </div>
    </div>
    <script type="importmap">
      {
      "imports": {
          "three": "https://unpkg.com/three@0.141.0/build/three.module.js",
           "GLTFLoader" : "https://unpkg.com/three@0.141.0/examples/jsm/loaders/GLTFLoader.js"
        }
      }
    </script>
    <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
    <script type="module">
        import {GLTFLoader} from 'GLTFLoader';
        import * as THREE from 'three';
        import { OrbitControls } from "https://threejs.org/examples/jsm/controls/OrbitControls.js"

        //let source = '/static/images/three/scene.gltf';
        let source = $('#t_test').val();
        let source1 = '';
        let scene = new THREE.Scene();
        let renderer = new THREE.WebGLRenderer({
            canvas : document.querySelector('#canvas3'),
            antialias : true
        });

        renderer.outputEncoding = THREE.sRGBEncoding;

        let camera = new THREE.PerspectiveCamera(30,1);
        const controls = new OrbitControls(camera, renderer.domElement)

        camera.position.set( 0, 0, 5 );
        controls.update();

        scene.background = new THREE.Color('white');

        let light = new THREE.DirectionalLight(0xffff00,10);
        scene.add(light);

        let loader = new GLTFLoader();
        loader.load(source, function(gltf){
            scene.add(gltf.scene);
            function animate(){
                requestAnimationFrame( animate );
                controls.update();
                renderer.render( scene, camera );
            }
            animate();
        })
    </script>
</div>
</html>